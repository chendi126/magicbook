# 🔍 搜索与筛选功能使用指南

## 功能概述

搜索与筛选功能让你可以快速找到需要的配色方案，支持多种筛选条件的组合使用。

---

## ✨ 功能特性

### 1. 搜索功能 🔍
- **实时搜索** - 输入时自动搜索
- **搜索范围** - 方案名称 + 标签名称
- **模糊匹配** - 支持部分关键词匹配
- **清除搜索** - 一键清除搜索内容

### 2. 标签筛选 🏷️
- **点击标签筛选** - 点击任意标签快速筛选
- **标签提示** - 显示当前筛选的标签
- **取消筛选** - 再次点击或点击 × 取消

### 3. 收藏筛选 ❤️
- **仅显示收藏** - 快速查看收藏的方案
- **切换状态** - 点击切换收藏筛选

### 4. 排序功能 📊
- **最新优先** - 按创建时间倒序（默认）
- **最早优先** - 按创建时间正序
- **名称 A-Z** - 按名称字母升序
- **名称 Z-A** - 按名称字母降序

### 5. 组合筛选 🎯
- **多条件组合** - 搜索 + 标签 + 收藏 + 排序
- **实时更新** - 筛选条件变化时立即更新
- **结果统计** - 显示筛选结果数量
- **清除筛选** - 一键清除所有筛选条件

---

## 📱 使用步骤

### 搜索方案

1. **打开配色库**
2. **点击搜索框**
3. **输入关键词**
   - 输入方案名称（如"夏日"）
   - 输入标签名称（如"自然"）
4. **查看结果**
   - 实时显示匹配的方案
   - 显示找到的方案数量

**示例**：
- 搜索"海滩" → 显示所有名称包含"海滩"的方案
- 搜索"自然" → 显示所有名称或标签包含"自然"的方案

---

### 标签筛选

1. **在配色库中找到任意方案**
2. **点击方案上的标签**
3. **查看筛选结果**
   - 只显示包含该标签的方案
   - 顶部显示"标签: xxx"
4. **取消筛选**
   - 再次点击同一标签，或
   - 点击标签提示右侧的 ×

---

### 收藏筛选

1. **点击筛选栏的"🤍 收藏"按钮**
2. **按钮变为"❤️ 收藏"（红色背景）**
3. **只显示收藏的方案**
4. **再次点击取消筛选**

---

### 排序方案

1. **点击筛选栏的"📊 排序"按钮**
2. **选择排序方式**：
   - ✓ 最新优先（默认）
   - 最早优先
   - 名称 A-Z
   - 名称 Z-A
3. **列表自动重新排序**

---

### 组合筛选

**场景 1：搜索 + 标签**
1. 搜索框输入"夏天"
2. 点击"清新"标签
3. 结果：名称或标签包含"夏天"，且有"清新"标签的方案

**场景 2：标签 + 收藏 + 排序**
1. 点击"自然"标签
2. 点击"❤️ 收藏"
3. 选择"名称 A-Z"排序
4. 结果：有"自然"标签且已收藏的方案，按名称排序

**场景 3：搜索 + 收藏**
1. 搜索框输入"海"
2. 点击"❤️ 收藏"
3. 结果：名称或标签包含"海"且已收藏的方案

---

## 🎯 UI 说明

### 配色库顶部布局

```
┌─────────────────────────────────┐
│ 配色库                          │
├─────────────────────────────────┤
│ [搜索方案名称或标签]        [×] │
├─────────────────────────────────┤
│ [🤍 收藏] [📊 最新]  清除筛选   │
├─────────────────────────────────┤
│ 标签: 自然 ×                    │
├─────────────────────────────────┤
│ 找到 5 个方案                   │
│                                 │
│ [方案列表...]                   │
└─────────────────────────────────┘
```

### 筛选状态指示

- **搜索框有内容** → 显示 × 清除按钮
- **收藏筛选开启** → 按钮变红色背景 ❤️
- **标签筛选开启** → 显示"标签: xxx ×"
- **有任何筛选** → 显示"清除筛选"按钮
- **有筛选结果** → 显示"找到 X 个方案"

---

## 🧪 测试场景

### 场景 1: 基础搜索
1. 保存 3 个方案：
   - "夏日海滩"
   - "冬日雪景"
   - "春天花园"
2. 搜索"夏"
3. **验证**: 只显示"夏日海滩" ✅

### 场景 2: 标签搜索
1. 方案"夏日海滩"有标签"自然"、"清新"
2. 搜索"清新"
3. **验证**: 显示"夏日海滩" ✅

### 场景 3: 组合筛选
1. 保存多个方案，部分收藏
2. 点击"自然"标签
3. 点击"❤️ 收藏"
4. **验证**: 只显示有"自然"标签且已收藏的方案 ✅

### 场景 4: 排序
1. 保存方案：A方案、C方案、B方案
2. 选择"名称 A-Z"
3. **验证**: 显示顺序为 A、B、C ✅

### 场景 5: 无结果
1. 搜索"不存在的关键词"
2. **验证**: 显示"🔍 没有找到匹配的方案" ✅
3. **验证**: 显示"试试调整筛选条件" ✅

---

## 💡 使用技巧

### 快速查找
- **按时间找** - 使用默认排序（最新优先）
- **按名称找** - 使用搜索框
- **按风格找** - 点击标签筛选
- **找收藏** - 点击收藏筛选

### 高效筛选
1. **先用标签缩小范围** - 点击标签
2. **再用搜索精确查找** - 输入关键词
3. **最后排序** - 选择合适的排序方式

### 清除筛选
- **清除单个** - 点击对应的 × 按钮
- **清除全部** - 点击"清除筛选"按钮

---

## 📊 筛选逻辑

### 筛选顺序
```
原始数据
  ↓
1. 搜索筛选（名称 + 标签）
  ↓
2. 标签筛选
  ↓
3. 收藏筛选
  ↓
4. 排序
  ↓
最终结果
```

### 搜索匹配规则
- **不区分大小写** - "Summer" 和 "summer" 等效
- **部分匹配** - "海" 可以匹配 "海滩"、"大海"
- **多字段搜索** - 同时搜索方案名称和标签

---

## 🎨 修改的文件

### `entry/src/main/ets/pages/LibraryPage.ets`

**新增状态变量**：
```typescript
@State searchKeyword: string = '';        // 搜索关键词
@State showFavoriteOnly: boolean = false; // 仅显示收藏
@State sortBy: string = 'time_desc';      // 排序方式
```

**新增方法**：
- `filterSchemes()` - 组合筛选逻辑
- `sortSchemes()` - 排序逻辑
- `clearAllFilters()` - 清除所有筛选
- `hasActiveFilters()` - 检查是否有筛选条件
- `getSortLabel()` - 获取排序标签
- `showSortMenu()` - 显示排序菜单（ActionSheet）

**UI 改动**：
- 添加搜索框
- 添加筛选器栏（收藏、排序）
- 添加清除筛选按钮
- 显示筛选结果数量
- 无结果提示

---

## ✅ 编译结果

```
✅ 0 ERROR
⚠️  42 WARN (可以忽略)
COMPILE RESULT: SUCCESS ✅
```

---

搜索与筛选功能让配色库管理更加高效便捷！🔍✨

